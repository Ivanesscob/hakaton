<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель</title>
    <link rel="stylesheet" href="/static/stylePanel.css">
</head>
<body background-color="black">
<div class="container">
    <div class="scene" id="scene-container">
        <!-- Блоки будут добавлены динамически -->
    </div>
    <div class="list" id="list-container">
        <!-- Блоки списка будут добавлены динамически -->
    </div>
    <div class="info-panel" id="info-panel">Выберите бизнес для просмотра информации</div>
</div>

<script>
    // Функция для загрузки данных о компании и бизнесах
    function loadCompanyData() {
        const companyData = JSON.parse(localStorage.getItem('companyData'));
        
        if (!companyData || companyData.status !== 'success') {
            console.error('Данные компании не найдены или неверный формат');
            window.location.href = '/auth/login';
            return;
        }
        
        const businesses = companyData.businesses || [];
        const sceneContainer = document.getElementById('scene-container');
        const listContainer = document.getElementById('list-container');
        
        // Очищаем контейнеры
        sceneContainer.innerHTML = '';
        listContainer.innerHTML = '';
        
        // Создаем блоки для каждого бизнеса
        businesses.forEach((business, index) => {
            // Создаем блок в сцене
            const sceneBox = document.createElement('div');
            sceneBox.className = 'scene-box';
            sceneBox.textContent = business.name;
            sceneBox.dataset.businessId = business._id;
            sceneBox.addEventListener('click', () => showBusinessInfo(business));
            sceneContainer.appendChild(sceneBox);
            
            // Создаем блок в списке
            const listBox = document.createElement('div');
            listBox.className = 'list-box';
            listBox.textContent = business.name;
            listBox.dataset.businessId = business._id;
            listBox.addEventListener('click', () => showBusinessInfo(business));
            listContainer.appendChild(listBox);
        });
    }
    
    // Функция для отображения информации о бизнесе
    function showBusinessInfo(business) {
        const infoPanel = document.getElementById('info-panel');
        
        let productsHtml = '';
        if (business.products && business.products.length > 0) {
            productsHtml = '<h3>Продукты:</h3><ul>';
            business.products.forEach(product => {
                productsHtml += `<li>${product.name} - ${product.price} руб.</li>`;
            });
            productsHtml += '</ul>';
        }
        
        infoPanel.innerHTML = `
            <h2>${business.name}</h2>
            <p>${business.description}</p>
            ${productsHtml}
        `;
    }
    
    // Загружаем данные при загрузке страницы
    document.addEventListener('DOMContentLoaded', loadCompanyData);
</script>
</body>
</html>